<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AI 동적 골격 낙상 예방 그룹 대시보드 - 건풍헬스테크놀로지</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap"
      rel="stylesheet"
    />
    <!-- 日期套件 -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css"
    />
    <link rel="stylesheet" href="style.css" />
  </head>
  <body class="bg-white">
    <div class="container custom-container pb-5 px-4">
      <!-- 統計資訊 -->
      <header class="custom-header mt-4 mb-4">
        <div class="d-flex justify-content-between align-items-center">
          <div>
            <h1 class="custom-title h3 h2-md h1-lg mb-1">
              AI 동적 골격 낙상 예방 그룹 대시보드
            </h1>
            <h2 class="custom-subtitle h5 h4-md h3-lg mb-0">삼나무</h2>
          </div>
          <div class="text-end">
            <p class="text-secondary mb-0">
              업데이트 날짜：<span class="fw-semibold">2025/07/15</span>
            </p>
          </div>
        </div>
        <div class="dropdown mt-3 d-flex justify-content-between">
          <button
            class="btn btn-primary dropdown-toggle"
            type="button"
            id="dropdownMenuButton"
            data-bs-toggle="dropdown"
            aria-expanded="false"
          ></button>
          <ul
            class="dropdown-menu"
            id="dropdownMenu"
            aria-labelledby="dropdownMenuButton"
          ></ul>
          <div class="d-flex gap-2 align-items-center">
            <!-- 語系切換 -->
            <div class="dropdown">
              <button
                class="btn btn-outline-primary fw-bold"
                type="button"
                id="languageMenu"
                data-bs-toggle="dropdown"
                aria-expanded="false"
              >
                한국어
              </button>
              <ul
                class="dropdown-menu dropdown-menu-end shadow-sm"
                aria-labelledby="languageMenu"
              >
                <li>
                  <button
                    class="dropdown-item"
                    onclick="switchLanguage('index.html')"
                  >
                    繁體中文
                  </button>
                </li>
                <li>
                  <button
                    class="dropdown-item"
                    onclick="switchLanguage('index_en.html')"
                  >
                    ENGLISH
                  </button>
                </li>
                <li>
                  <button
                    class="dropdown-item"
                    onclick="switchLanguage('index_ja.html')"
                  >
                    日本語
                  </button>
                </li>
                <li>
                  <button
                    class="dropdown-item"
                    onclick="switchLanguage('index_ko.html')"
                  >
                    한국어
                  </button>
                </li>
              </ul>
            </div>
            <button id="downloadBtn" class="btn btn-primary">
              <i class="bi bi-download me-1"></i> 下載
            </button>
          </div>
        </div>
      </header>
      <nav
        class="navbar navbar-expand-lg bg-white shadow-sm sticky-top border-bottom hide-on-all"
      >
        <div class="container-fluid">
          <!-- 手機版漢堡選單 -->
          <button
            class="navbar-toggler"
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#mainNavbar"
            aria-controls="mainNavbar"
            aria-expanded="false"
            aria-label="切換導航"
          >
            <span class="navbar-toggler-icon"></span>
          </button>

          <!-- 收合區塊 -->
          <div class="collapse navbar-collapse" id="mainNavbar">
            <ul class="navbar-nav me-auto mb-2 mb-lg-0">
              <li class="nav-item">
                <a class="nav-link fw-bold text-dark" href="#summary"
                  >테스트 통계 요약</a
                >
              </li>
              <li class="nav-item">
                <a class="nav-link fw-bold text-dark" href="#risk"
                  >위험 등급 통계</a
                >
              </li>
              <li class="nav-item">
                <a class="nav-link fw-bold text-dark" href="#trend"
                  >그룹 변화 추세</a
                >
              </li>
              <li class="nav-item">
                <a class="nav-link fw-bold text-dark" href="#status"
                  >참가자 상태</a
                >
              </li>
              <li class="nav-item">
                <a class="nav-link fw-bold text-dark" href="#location"
                  >테스트 위치 분포</a
                >
              </li>
            </ul>
          </div>
        </div>
      </nav>
      <!-- 檢測摘要 -->
      <div class="mb-4 mt-4 bg-white p-4 rounded shadow">
        <h5
          id="summary"
          class="fw-bold text-dark mb-3 d-flex align-items-center"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="me-2 text-primary"
            width="24"
            height="24"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"
            />
          </svg>
          테스트 통계 요약
        </h5>
        <div class="my-3 hide-on-all">
          <div class="input-group">
            <input
              type="text"
              id="dateRange"
              class="form-control"
              placeholder="날짜 범위를 선택해 주세요"
            />
            <button class="btn btn-outline-secondary" id="clearBtn">
              분명한
            </button>
          </div>
        </div>

        <!-- 統計資訊 -->
        <div class="row g-4">
          <div class="col-md-4 main-col">
            <div class="stat-card stat-blue">
              <h6 class="fw-semibold mb-2">총 검사 인원</h6>
              <div class="d-flex align-items-end">
                <span id="totalCount" class="display-6 fw-bold text-blue"
                  >0</span
                >
                <span class="ms-2 mb-1 text-blue">사람들</span>
              </div>
              <p id="startDateText" class="small mt-2 text-blue">
                아직 데이터가 없습니다
              </p>
            </div>
          </div>

          <div class="col-md-4 main-col">
            <div class="stat-card stat-green">
              <h6 class="fw-semibold mb-2">총 검사 횟수</h6>
              <div class="d-flex align-items-end">
                <span
                  id="latestCount"
                  class="display-6 fw-bold text-green"
                ></span>
                <span class="ms-2 mb-1 text-green">사람들</span>
              </div>
              <p id="latestDate" class="small mt-2 text-green"></p>
            </div>
          </div>

          <div class="col-md-4 sechide">
            <div class="stat-card stat-purple">
              <h6 class="fw-semibold mb-2">테스트 장소 수</h6>
              <div class="d-flex align-items-end">
                <span
                  id="locationCount"
                  class="display-6 fw-bold text-purple"
                ></span>
                <span class="ms-2 mb-1 text-purple">부서</span>
              </div>
              <p id="locationList" class="small mt-2 text-purple"></p>
            </div>
          </div>
        </div>

        <!-- 表格 -->
        <div class="mt-4 hide-on-all">
          <h6 class="fw-semibold text-secondary mb-3">
            모든 시간의 평균 시험 점수
          </h6>

          <div class="table-responsive">
            <div class="d-flex gap-2 mb-2">
              <button id="checkAllBtn" class="btn btn-outline-primary btn-sm">
                모두 선택
              </button>
              <button
                id="uncheckAllBtn"
                class="btn btn-outline-secondary btn-sm"
              >
                모두 선택 해제
              </button>
            </div>
            <table class="table table-bordered align-middle">
              <thead class="bg-light">
                <tr>
                  <th style="width: 50px">선택하다</th>
                  <th>테스트 날짜</th>
                  <th>참가자 수</th>
                  <th>앉고 서 있는 데 걸리는 평균 시간(초)</th>
                  <th>평균 잔액 점수</th>
                  <th>평균 보행 속도</th>
                  <th>평균 낙상 위험</th>
                </tr>
              </thead>

              <tbody id="assessmentTableBody"></tbody>
            </table>
            <div
              id="tablePaginationContainer"
              class="d-flex justify-content-between align-items-center mt-2 w-100"
            ></div>
          </div>
        </div>
      </div>
      <!-- 風險分級統計區塊 -->
      <div class="mb-4 hide-on-all">
        <h5 id="risk" class="fw-bold text-dark mb-3 d-flex align-items-center">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="me-2 text-primary"
            width="24"
            height="24"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"
            />
          </svg>
          위험 등급 통계
        </h5>

        <!-- 警示清單 -->
        <div class="alert-box mb-4 p-3 hide-on-all">
          <div class="d-flex align-items-center mb-2">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="me-2 text-warn"
              width="24"
              height="24"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"
              />
            </svg>
            <h6 class="fw-bold text-warn mb-0">경고 목록</h6>
          </div>
          <div class="row g-3">
            <div class="col-md-6">
              <p class="fw-semibold text-warn mb-1">
                기능 저하 경고 (이전 테스트 대비 10% 이상 저하)
              </p>
              <ul id="degenerateList" class="ms-4 text-secondary">
                <li>보행 속도 감소：<span></span>사람들</li>
                <li>윗몸 일으키기 시간 증가：<span></span>사람들</li>
              </ul>
            </div>
            <div class="col-md-6">
              <p class="fw-semibold text-warn mb-1">高風險族群</p>
              <ul id="levelList" class="ms-4 text-secondary">
                <li>A급 장애인：<span></span> 사람들</li>
                <li>B 레벨 약화：<span></span>사람들</li>
                <div class="d-flex justify-content-between flex-wrap">
                  <li>C레벨 초기 약점：<span></span>사람들</li>
                  <div class="mt-2">
                    <button
                      id="viewDetailsBtn"
                      class="btn btn-warning btn-sm d-inline-flex align-items-center"
                    >
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        class="me-1"
                        width="16"
                        height="16"
                        fill="none"
                        viewBox="0 0 24 24"
                        stroke="currentColor"
                      >
                        <path
                          stroke-linecap="round"
                          stroke-linejoin="round"
                          stroke-width="2"
                          d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"
                        />
                        <path
                          stroke-linecap="round"
                          stroke-linejoin="round"
                          stroke-width="2"
                          d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"
                        />
                      </svg>
                      자세한 목록 보기
                    </button>
                  </div>
                </div>
              </ul>
            </div>
          </div>
        </div>
        <!-- 詳細名單彈窗 -->
        <div
          class="modal fade"
          id="detailsModal"
          tabindex="-1"
          aria-labelledby="detailsModalLabel"
          aria-hidden="true"
        >
          <div
            class="modal-dialog modal-dialog-centered modal-dialog-scrollable modal-lg"
          >
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="detailsModalLabel">자세한 목록</h5>
                <button
                  type="button"
                  class="btn-close"
                  data-bs-dismiss="modal"
                  aria-label="Close"
                ></button>
              </div>

              <div class="modal-body">
                <div id="degenerateSection" class="mb-3">
                  <div class="row">
                    <div class="col-12 col-md-6 mb-2">
                      <div class="card">
                        <div class="card-header"></div>
                        <ul
                          class="list-group list-group-flush"
                          id="degenerateGaitSpeed"
                        ></ul>
                      </div>
                    </div>
                    <div class="col-12 col-md-6 mb-2">
                      <div class="card">
                        <div class="card-header"></div>
                        <ul
                          class="list-group list-group-flush"
                          id="degenerateChair"
                        ></ul>
                      </div>
                    </div>
                  </div>
                </div>

                <div id="vivifrailSection">
                  <div class="row">
                    <div class="col-12 col-md-4 mb-2">
                      <div class="card">
                        <div class="card-header"></div>
                        <ul
                          class="list-group list-group-flush"
                          id="vivifrailA"
                        ></ul>
                      </div>
                    </div>
                    <div class="col-12 col-md-4 mb-2">
                      <div class="card">
                        <div class="card-header"></div>
                        <ul
                          class="list-group list-group-flush"
                          id="vivifrailB"
                        ></ul>
                      </div>
                    </div>
                    <div class="col-12 col-md-4 mb-2">
                      <div class="card">
                        <div class="card-header"></div>
                        <ul
                          class="list-group list-group-flush"
                          id="vivifrailC"
                        ></ul>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="modal-footer">
                <button
                  type="button"
                  class="btn btn-secondary btn-sm"
                  data-bs-dismiss="modal"
                >
                  닫기
                </button>
              </div>
            </div>
          </div>
        </div>
        <!-- 衰退區塊 -->
        <div class="row g-3">
          <div class="col-md-6">
            <div
              class="risk-box p-3"
              style="border-left: 4px solid #6f42c1; background-color: #f3e9fa"
            >
              <div class="d-flex justify-content-between align-items-center">
                <div>
                  <h6 class="fw-bold mb-0 text-purple">보행 속도 감소</h6>
                </div>
                <div
                  class="fs-3 fw-bold text-purple"
                  id="degenerateGaitSpeedTotal"
                >
                  0
                </div>
              </div>
              <div class="mt-2 progress rounded-pill">
                <div
                  class="progress-bar bg-purple"
                  id="progressGaitSpeed"
                ></div>
              </div>
            </div>
          </div>

          <div class="col-md-6">
            <div
              class="risk-box p-3"
              style="border-left: 4px solid #0dcaf0; background-color: #e8f8fc"
            >
              <div class="d-flex justify-content-between align-items-center">
                <div>
                  <h6 class="fw-bold mb-0 text-info">
                    윗몸 일으키기 시간 증가
                  </h6>
                </div>
                <div class="fs-3 fw-bold text-info" id="degenerateChairTotal">
                  0
                </div>
              </div>
              <div class="mt-2 progress rounded-pill">
                <div class="progress-bar bg-info" id="progressChair"></div>
              </div>
            </div>
          </div>
        </div>

        <!-- 四個等級 -->
        <div class="row g-3 mt-4">
          <div class="col-md-3">
            <div class="risk-box risk-red p-3">
              <div class="d-flex justify-content-between align-items-center">
                <div>
                  <h6 class="fw-bold text-danger mb-0">A등급</h6>
                  <p class="small text-danger mb-0">장애인(SPPB=0-3점)</p>
                </div>
                <div class="fs-3 fw-bold text-danger" id="riskA">0</div>
              </div>
              <div class="mt-2 progress rounded-pill">
                <div
                  class="progress-bar bg-danger"
                  id="progressA"
                  style="width: 0%"
                ></div>
              </div>
            </div>
          </div>

          <div class="col-md-3">
            <div class="risk-box risk-yellow p-3">
              <div class="d-flex justify-content-between align-items-center">
                <div>
                  <h6 class="fw-bold text-warn mb-0">B등급</h6>
                  <p class="small text-warn mb-0">허약함(SPPB=4-6점)</p>
                </div>
                <div class="fs-3 fw-bold text-warn" id="riskB">0</div>
              </div>
              <div class="mt-2 progress rounded-pill">
                <div
                  class="progress-bar bg-warn"
                  id="progressB"
                  style="width: 0%"
                ></div>
              </div>
            </div>
          </div>

          <div class="col-md-3">
            <div class="risk-box risk-blue p-3">
              <div class="d-flex justify-content-between align-items-center">
                <div>
                  <h6 class="fw-bold text-primary mb-0">C등급</h6>
                  <p class="small text-primary mb-0">전노쇠성(SPPB=7-9점)</p>
                </div>
                <div class="fs-3 fw-bold text-primary" id="riskC">0</div>
              </div>
              <div class="mt-2 progress rounded-pill">
                <div
                  class="progress-bar bg-primary"
                  id="progressC"
                  style="width: 0%"
                ></div>
              </div>
            </div>
          </div>

          <div class="col-md-3">
            <div class="risk-box risk-green p-3">
              <div class="d-flex justify-content-between align-items-center">
                <div>
                  <h6 class="fw-bold text-success mb-0">D등급</h6>
                  <p class="small text-success mb-0">
                    건강한 사람(SPPB=10-12점)
                  </p>
                </div>
                <div class="fs-3 fw-bold text-success" id="riskD">0</div>
              </div>
              <div class="mt-2 progress rounded-pill">
                <div
                  class="progress-bar bg-success"
                  id="progressD"
                  style="width: 0%"
                ></div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- 群體變化趨勢 -->
      <div class="mb-8 hide-on-all">
        <h5 id="trend" class="fw-bold mb-3 d-flex align-items-center">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            class="me-2"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
            style="stroke: #3b82f6"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"
            />
          </svg>
          그룹 변화 추세
        </h5>

        <div class="container my-4">
          <div class="row g-4">
            <!-- 坐站平均秒數 -->
            <div class="col-12 col-md-6">
              <div class="card shadow-sm h-100">
                <div class="card-body">
                  <div
                    class="d-flex align-items-center justify-content-between"
                  >
                    <h5 class="fw-semibold text-dark">
                      평균 앉기-서기 시간 추이
                    </h5>
                    <button
                      class="btn btn-sm btn-outline-primary download-chart"
                      data-target="sitStandChartCanvas"
                    >
                      <i class="fa fa-download me-1"></i> 이미지 파일 다운로드
                    </button>
                  </div>

                  <div class="text-muted small mb-2">
                    권장 지속 시간: 12초 미만
                  </div>
                  <div
                    class="chart-container"
                    style="position: relative; height: 300px; width: 100%"
                  >
                    <canvas id="sitStandChartCanvas"></canvas>
                  </div>
                </div>
              </div>
            </div>
            <!-- 平衡測驗得分 -->
            <div class="col-12 col-md-6">
              <div class="card shadow-sm h-100">
                <div class="card-body">
                  <div
                    class="d-flex align-items-center justify-content-between"
                  >
                    <h5 class="fw-semibold text-dark">평균 균형 테스트 점수</h5>
                    <button
                      class="btn btn-sm btn-outline-primary download-chart"
                      data-target="balanceChartCanvas"
                    >
                      <i class="fa fa-download me-1"></i> 이미지 파일 다운로드
                    </button>
                  </div>

                  <div class="text-muted small mb-2">
                    3.5점 이상을 추천드립니다.
                  </div>
                  <div
                    class="chart-container"
                    style="height: 300px; width: 100%"
                  >
                    <canvas id="balanceChartCanvas"></canvas>
                  </div>
                </div>
              </div>
            </div>
            <!-- 步行速度趨勢 -->
            <div class="col-12 col-md-6">
              <div class="card shadow-sm h-100">
                <div class="card-body">
                  <div
                    class="d-flex align-items-center justify-content-between"
                  >
                    <h5 class="fw-semibold text-dark">평균 보행 속도 추세</h5>
                    <button
                      class="btn btn-sm btn-outline-primary download-chart"
                      data-target="gaitChartCanvas"
                    >
                      <i class="fa fa-download me-1"></i> 이미지 파일 다운로드
                    </button>
                  </div>

                  <div class="text-muted small mb-2">
                    권장 속도는 100cm/s 이상입니다.
                  </div>
                  <div
                    class="chart-container"
                    style="height: 300px; width: 100%"
                  >
                    <canvas id="gaitChartCanvas"></canvas>
                  </div>
                </div>
              </div>
            </div>
            <!-- 平均AI跌倒風險機率 -->
            <div class="col-12 col-md-6">
              <div class="card shadow-sm h-100">
                <div class="card-body">
                  <div
                    class="d-flex align-items-center justify-content-between"
                  >
                    <h5 class="fw-semibold text-dark">
                      평균 AI 낙상 위험 확률
                    </h5>
                    <button
                      class="btn btn-sm btn-outline-primary download-chart"
                      data-target="riskChartCanvas"
                    >
                      <i class="fa fa-download me-1"></i> 이미지 파일 다운로드
                    </button>
                  </div>

                  <div class="text-muted small mb-2" style="opacity: 0">
                    15615
                  </div>
                  <div
                    class="chart-container"
                    style="height: 300px; width: 100%"
                  >
                    <canvas id="riskChartCanvas"></canvas>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- 參與者狀態 -->
      <div class="mb-4 hide-on-all">
        <h5
          id="status"
          class="fw-bold text-dark mb-3 d-flex align-items-center"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="me-2 text-primary"
            width="24"
            height="24"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"
            />
          </svg>
          참가자 상태
        </h5>
        <div class="d-flex gap-2 mb-3 sortModeSwitch">
          <button
            type="button"
            class="btn btn-outline-primary active"
            id="riskModeBtn"
          >
            AI 낙상 위험 수준별로 정렬
          </button>
          <button
            type="button"
            class="btn btn-outline-primary"
            id="levelModeBtn"
          >
            Vivifrial 레벨별로 정렬
          </button>
        </div>
        <div class="risk" id="riskContainer">
          <!-- 篩選按鈕 -->
          <div class="d-none d-md-flex gap-2 mb-3 filterBtnsDesktop">
            <button
              type="button"
              class="btn btn-secondary flex-fill active text-white"
              data-risk="all"
            >
              모두
            </button>
            <button
              type="button"
              class="btn btn-danger flex-fill risk-high-danger text-white"
              data-risk="high"
            >
              위험
            </button>
            <button
              type="button"
              class="btn btn-warning flex-fill risk-high text-white"
              data-risk="slightlyHigh"
            >
              높은
            </button>
            <button
              type="button"
              class="btn btn-primary flex-fill risk-medium text-white"
              data-risk="medium"
            >
              가운데
            </button>
            <button
              type="button"
              class="btn btn-info flex-fill risk-slightly-low text-white"
              data-risk="slightlyLow"
            >
              약간 낮음
            </button>
            <button
              type="button"
              class="btn btn-success flex-fill risk-low text-white"
              data-risk="low"
            >
              낮은
            </button>
          </div>

          <!-- 篩選區：手機版下拉 -->
          <div class="dropdown d-md-none mb-3 filterDropdownMobile">
            <button
              class="btn btn-outline-secondary dropdown-toggle w-100"
              type="button"
              data-bs-toggle="dropdown"
            >
              위험을 선택해주세요
            </button>
            <ul class="dropdown-menu w-100">
              <li>
                <a class="dropdown-item" href="#" data-risk="all">모두</a>
              </li>
              <li>
                <a class="dropdown-item" href="#" data-risk="high">위험</a>
              </li>
              <li>
                <a class="dropdown-item" href="#" data-risk="slightlyHigh"
                  >높은</a
                >
              </li>
              <li>
                <a class="dropdown-item" href="#" data-risk="medium">가운데</a>
              </li>
              <li>
                <a class="dropdown-item" href="#" data-risk="slightlyLow"
                  >약간 낮음</a
                >
              </li>
              <li>
                <a class="dropdown-item" href="#" data-risk="low">낮은</a>
              </li>
            </ul>
          </div>
          <!-- 人員區塊 -->
          <div class="row g-3" id="personContainer"></div>

          <div class="mt-3 text-end">
            <button
              id="viewAllBtn"
              class="btn btn-primary btn-sm d-inline-flex align-items-center viewAllBtn"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="me-1"
                width="16"
                height="16"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"
                />
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"
                />
              </svg>
              모든 참가자 보기
            </button>
          </div>
          <!-- 查看全部彈窗 -->
          <div class="modal fade" id="participantsModal" tabindex="-1">
            <div class="modal-dialog modal-xl modal-dialog-scrollable">
              <div class="modal-content">
                <div class="modal-header flex-column">
                  <h5 class="modal-title w-100">참가자 상태</h5>

                  <!-- 分類按鈕：桌機版 -->
                  <div
                    class="d-none d-md-flex gap-2 mt-2 w-100"
                    id="modalFilterBtnsDesktop"
                  >
                    <button
                      type="button"
                      class="btn btn-secondary flex-fill active text-white"
                      data-risk="all"
                    >
                      모두
                    </button>
                    <button
                      type="button"
                      class="btn btn-danger flex-fill risk-high-danger text-white"
                      data-risk="high"
                    >
                      위험
                    </button>
                    <button
                      type="button"
                      class="btn btn-warning flex-fill risk-high text-white"
                      data-risk="slightlyHigh"
                    >
                      높은
                    </button>
                    <button
                      type="button"
                      class="btn btn-primary flex-fill risk-medium text-white"
                      data-risk="medium"
                    >
                      가운데
                    </button>
                    <button
                      type="button"
                      class="btn btn-info flex-fill risk-slightly-low text-white"
                      data-risk="slightlyLow"
                    >
                      약간 낮음
                    </button>
                    <button
                      type="button"
                      class="btn btn-success flex-fill risk-low text-white"
                      data-risk="low"
                    >
                      낮은
                    </button>
                  </div>

                  <!-- 分類下拉：手機版 -->
                  <div
                    class="dropdown d-md-none mt-2 w-100"
                    id="modalFilterDropdownMobile"
                  >
                    <button
                      class="btn btn-outline-secondary dropdown-toggle w-100"
                      type="button"
                      data-bs-toggle="dropdown"
                    >
                      リスクを選択してください
                    </button>
                    <ul class="dropdown-menu w-100">
                      <li>
                        <a class="dropdown-item" href="#" data-risk="all"
                          >모두</a
                        >
                      </li>
                      <li>
                        <a class="dropdown-item" href="#" data-risk="high"
                          >위험</a
                        >
                      </li>
                      <li>
                        <a
                          class="dropdown-item"
                          href="#"
                          data-risk="slightlyHigh"
                          >높은</a
                        >
                      </li>
                      <li>
                        <a class="dropdown-item" href="#" data-risk="medium"
                          >가운데</a
                        >
                      </li>
                      <li>
                        <a
                          class="dropdown-item"
                          href="#"
                          data-risk="slightlyLow"
                          >약간 낮음</a
                        >
                      </li>
                      <li>
                        <a class="dropdown-item" href="#" data-risk="low"
                          >낮은</a
                        >
                      </li>
                    </ul>
                  </div>

                  <button
                    type="button"
                    class="btn-close mt-2"
                    data-bs-dismiss="modal"
                  ></button>
                </div>

                <div class="modal-body">
                  <div class="row g-3" id="modalPersonContainer"></div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="level" id="levelContainer">
          <!-- 篩選按鈕：桌機版 -->
          <div class="d-none d-md-flex gap-2 mb-3 levelFilterBtnsDesktop">
            <button
              type="button"
              class="btn btn-secondary flex-fill active text-white"
              data-filter="all"
            >
              모두
            </button>
            <button
              type="button"
              class="btn btn-danger flex-fill text-white"
              data-filter="A"
            >
              A등급: 장애인
            </button>
            <button
              type="button"
              class="btn btn-warning flex-fill text-white"
              data-filter="B"
            >
              B등급: 허약자
            </button>
            <button
              type="button"
              class="btn btn-primary flex-fill text-white"
              data-filter="C"
            >
              C등급: 전(前)허약자
            </button>
            <button
              type="button"
              class="btn btn-success flex-fill text-white"
              data-filter="D"
            >
              D등급: 건강자
            </button>
          </div>

          <!-- 篩選區：手機版下拉 -->
          <div class="dropdown d-md-none mb-3 levelFilterDropdownMobile">
            <button
              class="btn btn-outline-secondary dropdown-toggle w-100"
              type="button"
              data-bs-toggle="dropdown"
            >
              레벨을 선택해주세요
            </button>
            <ul class="dropdown-menu w-100">
              <li>
                <a class="dropdown-item" href="#" data-filter="all">모두</a>
              </li>
              <li>
                <a class="dropdown-item" href="#" data-filter="A"
                  >A등급: 장애인</a
                >
              </li>
              <li>
                <a class="dropdown-item" href="#" data-filter="B"
                  >B등급: 허약자</a
                >
              </li>
              <li>
                <a class="dropdown-item" href="#" data-filter="C"
                  >C등급: 전(前)허약자</a
                >
              </li>
              <li>
                <a class="dropdown-item" href="#" data-filter="D"
                  >D등급: 건강자</a
                >
              </li>
            </ul>
          </div>

          <!-- 人員區塊 -->
          <div class="row g-3" id="levelPersonContainer"></div>

          <!-- 查看全部參與者按鈕 -->
          <div class="mt-3 text-end">
            <button
              id="viewAllLevelBtn"
              class="btn btn-primary btn-sm d-inline-flex align-items-center viewAllBtn"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="me-1"
                width="16"
                height="16"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"
                />
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"
                />
              </svg>
              모든 참가자 보기
            </button>
          </div>

          <!-- 查看全部彈窗 -->
          <div class="modal fade" id="participantsLevelModal" tabindex="-1">
            <div class="modal-dialog modal-xl modal-dialog-scrollable">
              <div class="modal-content">
                <div class="modal-header flex-column">
                  <h5 class="modal-title w-100">참가자 상태</h5>

                  <!-- 桌機版篩選按鈕 -->
                  <div
                    class="d-none d-md-flex gap-2 mt-2 w-100"
                    id="modalLevelFilterBtnsDesktop"
                  >
                    <button
                      type="button"
                      class="btn btn-secondary flex-fill active text-white"
                      data-filter="all"
                    >
                      모두
                    </button>
                    <button
                      type="button"
                      class="btn btn-danger flex-fill text-white"
                      data-filter="A"
                    >
                      A등급: 장애인
                    </button>
                    <button
                      type="button"
                      class="btn btn-warning flex-fill text-white"
                      data-filter="B"
                    >
                      B등급: 허약자
                    </button>
                    <button
                      type="button"
                      class="btn btn-primary flex-fill text-white"
                      data-filter="C"
                    >
                      C등급: 전(前)허약자
                    </button>
                    <button
                      type="button"
                      class="btn btn-success flex-fill text-white"
                      data-filter="D"
                    >
                      D등급: 건강자
                    </button>
                  </div>

                  <!-- 手機版篩選下拉 -->
                  <div
                    class="dropdown d-md-none mt-2 w-100"
                    id="modalLevelFilterDropdownMobile"
                  >
                    <button
                      class="btn btn-outline-secondary dropdown-toggle w-100"
                      type="button"
                      data-bs-toggle="dropdown"
                    >
                      레벨을 선택해주세요
                    </button>
                    <ul class="dropdown-menu w-100">
                      <li>
                        <a class="dropdown-item" href="#" data-filter="all"
                          >모두</a
                        >
                      </li>
                      <li>
                        <a class="dropdown-item" href="#" data-filter="A"
                          >A등급: 장애인</a
                        >
                      </li>
                      <li>
                        <a class="dropdown-item" href="#" data-filter="B"
                          >B등급: 허약자</a
                        >
                      </li>
                      <li>
                        <a class="dropdown-item" href="#" data-filter="C"
                          >C등급: 전(前)허약자</a
                        >
                      </li>
                      <li>
                        <a class="dropdown-item" href="#" data-filter="D"
                          >D등급: 건강자</a
                        >
                      </li>
                    </ul>
                  </div>

                  <button
                    type="button"
                    class="btn-close mt-2"
                    data-bs-dismiss="modal"
                  ></button>
                </div>

                <div class="modal-body">
                  <div class="row g-3" id="modalLevelPersonContainer"></div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- 地圖區塊 -->
      <div class="mb-4">
        <h5
          id="location"
          class="fw-bold text-dark mb-3 d-flex align-items-center"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="me-2 text-primary"
            width="24"
            height="24"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"
            />
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"
            />
          </svg>
          테스트 위치 분포
        </h5>

        <!-- 地圖 -->
        <div id="map"></div>
        <!-- 等級人員彈窗 -->
        <div
          class="modal fade"
          id="personDetailModal"
          tabindex="-1"
          aria-hidden="true"
        >
          <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="personDetailTitle"></h5>
                <button
                  type="button"
                  class="btn-close"
                  data-bs-dismiss="modal"
                  aria-label="Close"
                ></button>
              </div>
              <div class="modal-body" id="personDetailBody"></div>
            </div>
          </div>
        </div>
        <!--  Cookie 提示區 -->
        <div id="cookieConsent">
          <p>
            저희는 쿠키를 사용하여 사용자의 언어 설정을 기록합니다.
            동의하시겠습니까?
          </p>
          <div class="d-flex justify-content-end gap-2">
            <button class="btn btn-primary" id="acceptCookies">동의</button>
            <button class="btn btn-secondary" id="rejectCookies">거부</button>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
<!-- 日期套件 -->
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
<script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/zh-tw.js"></script>
<script src="lang.js"></script>
<script src="map.js"></script>
<script src="main.js"></script>
<script src="cookie.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@3.0.1"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<!-- pdf下載 -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script
  src="https://maps.googleapis.com/maps/api/js?key=AIzaSyACfOxn7DJ9gdcb-XBx-R2X5pbHWeskzUg&callback=initMap"
  async
  defer
></script>
<script>
  window.currentLang = "ko";
</script>
